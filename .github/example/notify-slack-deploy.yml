# ============================================================================
#                         ğŸ“¢ ë°°í¬ ì•Œë¦¼ ì„¤ì • ê°€ì´ë“œ
# ============================================================================
#
# ğŸ¯ ëª©ì : ë°°í¬ ì„±ê³µ/ì‹¤íŒ¨ ì‹œ Slack ì±„ë„ì— ìë™ìœ¼ë¡œ ì•Œë¦¼ì„ ë³´ëƒ…ë‹ˆë‹¤.
#
# âš ï¸  ì£¼ì˜ì‚¬í•­ (ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”!)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1. ì´ íŒŒì¼ì€ ì˜ˆì‹œì…ë‹ˆë‹¤. ê¸°ì¡´ ë°°í¬ ì›Œí¬í”Œë¡œìš°ì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€í•˜ì„¸ìš”.
#
# 2. í•„ìˆ˜ Secrets ì„¤ì • (Repository Settings > Secrets and variables > Actions):
#    - SLACK_BOT_TOKEN: Slack Botì˜ OAuth Token (xoxb-ë¡œ ì‹œì‘)
#    - SLACK_CHANNEL_ID: ì•Œë¦¼ì„ ë°›ì„ Slack ì±„ë„ ID (Cë¡œ ì‹œì‘í•˜ëŠ” 11ìë¦¬)
#
# 4. ì›Œí¬í”Œë¡œìš° ê²½ë¡œ: ì•„ë˜ ë‘ ê°€ì§€ ë°©ì‹ ì¤‘ ì„ íƒ
#    - ì¤‘ì•™ ë ˆí¬ ì‚¬ìš©: demodev-lab/.github/.github/workflows/notify-slack-deploy.yml@main
#    - ë¡œì»¬ ì‚¬ìš©: ./.github/workflows/notify-slack-deploy.yml (íŒŒì¼ ë³µì‚¬ í•„ìš”)
#
# 5. 'needs' ê°’ì„ ì‹¤ì œ ë°°í¬ job ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”.
#    ì˜ˆ: needs: deploy, needs: build-and-deploy, needs: production-deploy
#
# 6. if ì¡°ê±´ ì„¤ëª…:
#    - success(): ì´ì „ jobì´ ì„±ê³µí–ˆì„ ë•Œë§Œ ì‹¤í–‰
#    - failure(): ì´ì „ jobì´ ì‹¤íŒ¨í–ˆì„ ë•Œë§Œ ì‹¤í–‰
#    - always(): ì„±ê³µ/ì‹¤íŒ¨ ê´€ê³„ì—†ì´ í•­ìƒ ì‹¤í–‰ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
#
# ============================================================================

# ì•„ë˜ëŠ” ê¸°ì¡´ ë°°í¬ ì›Œí¬í”Œë¡œìš°ì— ì¶”ê°€í•  ë‚´ìš©ì…ë‹ˆë‹¤.
# ----------------------------------------------------------------------------

name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Deploy Application
        run: |
          # ì‹¤ì œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì—¬ê¸°ì— ì‘ì„±í•˜ì„¸ìš”
          echo "Deploying..."

# ============================================================================
#          â¬‡ï¸ ì—¬ê¸°ì„œë¶€í„° ê¸°ì¡´ ì›Œí¬í”Œë¡œìš°ì— ì¶”ê°€í•˜ì„¸ìš” â¬‡ï¸
# ============================================================================

  # ë°°í¬ ì„±ê³µ ì‹œ ì•Œë¦¼
  notify-success:
    needs: deploy  # âš ï¸ ì‹¤ì œ ë°°í¬ job ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”
    if: success()
    uses: demodev-lab/.github/.github/workflows/notify-slack-deploy.yml@main
    with:
      status: 'success'
    secrets:
      SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
      SLACK_CHANNEL_ID: ${{ secrets.SLACK_CHANNEL_ID }}

  # ë°°í¬ ì‹¤íŒ¨ ì‹œ ì•Œë¦¼
  notify-failure:
    needs: deploy  # âš ï¸ ì‹¤ì œ ë°°í¬ job ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”
    if: failure()
    uses: demodev-lab/.github/.github/workflows/notify-slack-deploy.yml@main
    with:
      status: 'failure'
    secrets:
      SLACK_BOT_TOKEN: ${{ secrets.SLACK_BOT_TOKEN }}
      SLACK_CHANNEL_ID: ${{ secrets.SLACK_CHANNEL_ID }}